var p=class{constructor(...e){this.colorStops=e}toRgb(e,t){let[r,n,i,a]=e,o=[r,n,i].join(" "),s=t&&a!==void 0?` / ${a}`:"";return`rgb(${o}${s})`}create(e,t,...r){let[n,i,,a]=r,o=e.createLinearGradient(n,i,0,a);for(let[s,c]of this.colorStops)o.addColorStop(s,this.toRgb(c,t));return o}render(e,t,...r){let n=this.create(e,t,...r);e.save(),e.fillStyle=n,e.fillRect(...r),e.restore()}};var y=class extends p{constructor(){super([0,[15,3,40,1]],[1,[31,29,52,1]])}};var w;(r=>(r.easeIn=(n,i=1.67)=>n**i,r.easeOut=(n,i=1.67)=>1-Math.max(1-n,0)**i,r.easeInOut=n=>.5*(Math.sin((n-.5)*Math.PI)+1)))(w||(w={}));var u=class{constructor(e){this.debug=(...e)=>this.console.debug(...e);this.info=(...e)=>this.console.info(...e);this.warn=(...e)=>this.console.warn(...e);this.error=(...e)=>this.console.error(...e);this.console=e!=null?e:console}};var f=class{constructor(e,t=new u){this.logger=t;this.image=null;this.config={...e}}static loadImageAsync(e){return new Promise((t,r)=>{let n=new Image;n.onload=()=>t(n),n.onerror=(i,a,o,s,c)=>r(c!=null?c:new Error(`Image failed to load: ${e}`)),n.src=e})}get size(){return[...this.config.size]}set size(e){this.config.size=[...e]}async initAsync(){return this.image=await f.loadImageAsync(this.config.url),this}createFrameRenderer(e){let t=0,r=!1,n=.8;return i=>{if(t<1){let l=Math.min(w.easeInOut(i*6e-5),1);t=l>t?l:1}else r||(this.logger.debug("Logo animation done",i,t),r=!0);let[a,o]=this.size,s=Math.min(a,o)*t*n,c=[s,s],d=[...[(a-s)/2,(o-s)/(1.52+.68*t)],...c];return e.drawImage(this.image,...d),!0}}};var v;(e=>{function g(...t){return t.reduce((r,n)=>r+n/t.length,0)}e.avg=g})(v||(v={}));var S=class{constructor(e,t){this.cbRenderFrame=e;this.cbStopped=t;this.started=!1;this.currAnimationFrame=null}start(){let e=!this.started,t=r=>{var n;this.started&&(this.started=this.cbRenderFrame(r)),this.started?this.currAnimationFrame=requestAnimationFrame(t):(n=this.cbStopped)==null||n.call(this)};return this.started=!0,this.currAnimationFrame=requestAnimationFrame(t),e}stop(){var t;let e=this.started;return this.started=!1,this.currAnimationFrame&&cancelAnimationFrame(this.currAnimationFrame),e&&((t=this.cbStopped)==null||t.call(this)),e}};var F=class{constructor(e){this.horizontalLines=[];this.verticalLines=[];this.canvasAnimation=null;this.config={...this.getDefaultOptions(),...e!=null?e:{}},this.createVerticalLines(),this.createHorizontalLines()}get center(){let[e,t]=this.size;return[e/2,t/2]}get lineWidth(){return v.avg(...this.config.size)*.001*this.config.lineScaling}getDefaultOptions(){return{size:[960,540],fieldOfView:512,viewDistance:12,angle:-75,gridSize:12,lineScaling:1}}rotateX(...e){let[t,r]=e,{angle:n,fieldOfView:i,viewDistance:a}=this.config,o=n*Math.PI/180,s=Math.cos(o),c=Math.sin(o),m=r*s,d=r*c,l=i/(a+d);return t=t*l+this.center[0],r=m*l+this.center[1],[t,r]}createVerticalLines(){let{gridSize:e}=this.config,t,r;this.verticalLines.splice(0);for(let n=-e;n<=e;n++)t=this.rotateX(n,-e),r=this.rotateX(n,e),this.verticalLines.push([t,r])}createHorizontalLines(e=0){let{gridSize:t}=this.config,r,n;this.horizontalLines.splice(0);for(let i=-t;i<=t;i++)r=this.rotateX(-t,i+e/100),n=this.rotateX(t,i+e/100),this.horizontalLines.push([r,n])}drawCanvasLine(e,t,r){let[n,i]=t;e.save(),e.lineWidth=this.lineWidth,e.beginPath(),e.moveTo(...n),e.lineTo(...i),e.strokeStyle=r,e.closePath(),e.stroke(),e.restore()}toSvgLine(e,t,r="  "){let[[n,i],[a,o]]=e;return`${r}<line x1="${n}" y1="${i}" x2="${a}" y2="${o}" stroke="${t}"/>`}get size(){return[...this.config.size]}set size(e){this.config.size=e}get angle(){return this.config.angle}set angle(e){this.config.angle=e}get fieldOfView(){return this.config.fieldOfView}set fieldOfView(e){this.config.fieldOfView=e}renderToCanvas(e,t,r){r&&e.clearRect(0,0,...this.size);for(let n of this.verticalLines)this.drawCanvasLine(e,n,t.verStrokeStyle);for(let n of this.horizontalLines)this.drawCanvasLine(e,n,t.horStrokeStyle)}toSvg(e){let[t,r]=this.size;return[`<svg width="${t}" height="${r}" xmlns="http://www.w3.org/2000/svg">`,...this.verticalLines.map(n=>this.toSvgLine(n,e.verStrokeStyle)),...this.horizontalLines.map(n=>this.toSvgLine(n,e.horStrokeStyle)),"</svg>"].join(`
`)}createFrameRenderer(e,t){let r=0,n=0,i=0;return a=>{var d,l;let o=a-n,s=o/1e3*((d=t.rotateDegPerSecond)!=null?d:0);this.angle+=s%360;let c=!0;n=a;let m=o*((l=t.gridRowsPerSecond)!=null?l:3)/10;return this.createVerticalLines(),this.createHorizontalLines(r),this.renderToCanvas(e,t,!t.skipClear),r+m>=100&&i++,i<0&&(c=!1),r=(r+m)%100,c}}startCanvasAnimation(e,t,r){return this.canvasAnimation=new S(this.createFrameRenderer(e,t),r),this.canvasAnimation.start()}stopCanvasAnimation(){var e,t;return(t=(e=this.canvasAnimation)==null?void 0:e.stop())!=null?t:!1}};var R=class extends p{constructor(){super([0,[26,4,48,0]],[.3,[26,4,48,0]],[.5,[7,1,10,.7]],[.6,[4,1,5,.99]],[.65,[1,1,1,1]],[.68,[4,1,7,.99]],[.78,[11,10,17,.7]],[1,[41,39,62,0]])}};var h=class{constructor(e){this.config={patternSizeFactor:.5,starScaling:1,...e},this.origSize=[...e.size],this.stars=h.createStars(this.config,this.patternSize)}get patternSize(){let[e,t]=this.size;return[e*this.config.patternSizeFactor,t*this.config.patternSizeFactor]}get scaling(){return[this.size[0]/this.origSize[0],this.size[1]/this.origSize[1]]}get size(){return this.config.size}set size(e){this.config.size=[...e],this.animationState&&(this.animationState.pattern=this.createPattern(this.animationState.ctx))}static createStars(e,t){let r=[],[n,i]=t;for(let a=0;a<e.starCount;++a){let o=Math.random()*n,s=Math.random()*i,c=Math.random()*(v.avg(...e.size)*.001*e.starScaling);r.push([o,s,c])}return r}static renderStars(e,t,r){for(let n of e)t.beginPath(),t.arc(...n,0,2*Math.PI,!1),t.fillStyle=r,t.fill()}createPattern(e){let t=document.createElement("canvas");[t.width,t.height]=this.patternSize;let r=t.getContext("2d");return r.scale(...this.scaling),h.renderStars(this.stars,r,this.config.color),e.createPattern(t,"repeat")}createFrameRenderer(e,t){var a;let r=t.rotateDegPerSecond*(Math.PI/180);this.animationState={ctx:e,pattern:this.createPattern(e)};let[n,i]=(a=t.rotateCenterFactors)!=null?a:[.5,.65];return o=>{let s=o/1e3*r%(Math.PI*2),[c,m]=this.size;e.save(),e.translate(c*n,m*i),e.rotate(s),e.beginPath();let d=Math.sqrt((c*Math.max(n,1-n))**2+(m*Math.max(i,1-i))**2);return e.arc(0,0,d,0,2*Math.PI),e.fillStyle=this.animationState.pattern,e.fill(),e.strokeStyle="#FFF",e.stroke(),e.restore(),!0}}};var b;(i=>{let g=new u;function e(a,o){let s=null,c=()=>{s&&(clearTimeout(s),s=null),o==null||o.removeEventListener("abort",c),g.debug("Delay aborted")};return new Promise(m=>{s=setTimeout(m,a),o==null||o.addEventListener("abort",c)})}i.delayAsync=e;let t,r;function n(a,o){t=a,r&&r.abort("debounced"),r=new AbortController,e(o,r.signal).then(t)}i.debounce=n})(b||(b={}));var L=class{constructor(e,t){this.getSize=t;this.onWindowResize=e=>{b.debounce(async()=>{let t=this.assets;if(t){await b.delayAsync(200);let r=this.getSize(),[,n]=this.size=t.grid.size=t.logo.size=t.starField.size=[this.ctx.canvas.width,this.ctx.canvas.height]=r;t.grid.fieldOfView=n/2}},250)};let r=typeof e=="string"?document.querySelector(e):e;if(!r)throw new Error("Invali container argument");this.container=r;let[n,i]=this.size=t();this.ctx=this.appendCanvas(...this.size),this.assets={bg:new y,shadow:new R,starField:new h({size:this.size,patternSizeFactor:.5,starCount:360,starScaling:1,color:"rgb(255 255 255 / .6)"}),grid:new F({size:this.size,viewDistance:26,gridSize:23,angle:285,fieldOfView:i/2,lineScaling:1}),logo:new f({url:"./images/bare_saa_80_logo_nobg.svg",size:[n,i]})},this.ctorPromise=this.assets.logo.initAsync()}appendCanvas(e,t){let r=document.createElement("canvas");r.width=e,r.height=t,this.container.appendChild(r);let n=r.getContext("2d");return n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high",n}async start(){await this.ctorPromise,window.addEventListener("resize",this.onWindowResize);let{bg:e,shadow:t,starField:r,grid:n,logo:i}=this.assets,a=r.createFrameRenderer(this.ctx,{rotateDegPerSecond:-3,rotateCenterFactors:[.5,.65]}),o=n.createFrameRenderer(this.ctx,{horStrokeStyle:"rgb(97 161 172 / .42)",verStrokeStyle:"rgb(255 255 255 / .15)",gridRowsPerSecond:2,rotateDegPerSecond:0,skipClear:!0}),s=i.createFrameRenderer(this.ctx),c=3e3;new S(d=>{let l=this.ctx,[P,C]=this.size,z=!0;return l.clearRect(0,0,l.canvas.width,l.canvas.height),e.render(l,!1,0,0,P,C),z=a(d),l.save(),l.translate(0,C/4.25),z=o(d),l.restore(),l.save(),l.rotate(Math.PI),l.translate(-P,C*-1.06),z=o(d),l.restore(),t.render(l,!0,0,0,P,C),d>c&&s(d-c),z}).start()}};var A=new L(document.body,()=>[window.innerWidth,window.innerHeight]);A.start();
//# sourceMappingURL=index.js.map
