import{BgGradient as v}from"./assets/bg-gradient.js";import{Logo as w}from"./assets/logo.js";import{PerspectiveGrid as z}from"./assets/perspective-grid.js";import{ShadowGradient as f}from"./assets/shadow-gradient.js";import{Starfield as S}from"./assets/starfield.js";import{FrameAnimation as y}from"./lib/frame-animation.js";import{Timing as m}from"./lib/timing.js";class G{constructor(s,t){this.getSize=t;this.onWindowResize=s=>{m.debounce(async()=>{const t=this.assets;if(t){await m.delayAsync(200);const r=this.getSize(),[,i]=this.size=t.grid.size=t.logo.size=t.starField.size=[this.ctx.canvas.width,this.ctx.canvas.height]=r;t.grid.fieldOfView=i/2}},250)};const r=typeof s=="string"?document.querySelector(s):s;if(!r)throw new Error("Invali container argument");this.container=r;const[i,n]=this.size=t();this.ctx=this.appendCanvas(...this.size),this.assets={bg:new v,shadow:new f,starField:new S({size:this.size,patternSizeFactor:.5,starCount:360,starScaling:1,color:"rgb(255 255 255 / .6)"}),grid:new z({size:this.size,viewDistance:26,gridSize:23,angle:285,fieldOfView:n/2,lineScaling:1}),logo:new w({url:"./images/bare_saa_80_logo_nobg.svg",size:[i,n]})},this.ctorPromise=this.assets.logo.initAsync()}appendCanvas(s,t){const r=document.createElement("canvas");r.width=s,r.height=t,this.container.appendChild(r);const i=r.getContext("2d");return i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i}async start(){await this.ctorPromise,window.addEventListener("resize",this.onWindowResize);const{bg:s,shadow:t,starField:r,grid:i,logo:n}=this.assets,l=r.createFrameRenderer(this.ctx,{rotateDegPerSecond:-3,rotateCenterFactors:[.5,.65]}),g=i.createFrameRenderer(this.ctx,{horStrokeStyle:"rgb(97 161 172 / .42)",verStrokeStyle:"rgb(255 255 255 / .15)",gridRowsPerSecond:2,rotateDegPerSecond:0,skipClear:!0}),p=n.createFrameRenderer(this.ctx),h=3e3;new y(a=>{const e=this.ctx,[c,o]=this.size;let d=!0;return e.clearRect(0,0,e.canvas.width,e.canvas.height),s.render(e,!1,0,0,c,o),d=l(a),e.save(),e.translate(0,o/4.25),d=g(a),e.restore(),e.save(),e.rotate(Math.PI),e.translate(-c,o*-1.06),d=g(a),e.restore(),t.render(e,!0,0,0,c,o),a>h&&p(a-h),d}).start()}}export{G as Bs80Animation};
//# sourceMappingURL=bs80-animation.js.map
